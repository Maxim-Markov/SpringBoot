<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dashboard Template Â· Bootstrap v5.0</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">

    <link href="sidebars.css" rel="stylesheet">

    <style>

    </style>
</head>
<body>
<header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
    <span class="navbar-brand col-md-3 col-lg-2 me-0 px-3"  th:each="role,iter : ${currentUser.getRoles()}"
          th:utext="(${iter.first} ? ('<b>' + ${currentUser.email} + '</b>' +' with roles: ')) + ${role.role.replaceFirst('ROLE_','')}+(${!iter.last} ? ', ' : '')"> </span>
    <div class="navbar-nav">
        <div class="nav-item text-nowrap">
            <a class="nav-link px-3" href="/logout">Logout</a>
        </div>
    </div>
</header>

<div class="container-fluid">
    <div class="row">
        <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
            <div class="d-flex flex-column flex-shrink-0">
                <ul class="nav nav-pills flex-column mb-auto">
                    <li class="nav-item" th:each="authority : ${#authentication.getAuthorities()}" th:if="${authority.getAuthority().startsWith('ROLE_ADMIN')}">
                        <a href="/admin" class="nav-link active" aria-current="page">
                            Admin
                        </a>
                    </li>
                    <li>
                        <a href="/user" class="nav-link link-dark">
                            User
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <h1>Admin panel</h1>
            <div class="bd-example">
                <nav>
                    <div class="nav nav-tabs mb-3" id="nav-tab" role="tablist">
                        <button class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">Users Table</button>
                        <button class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">New User</button>
                    </div>
                </nav>
                <div class="tab-content" id="nav-tabContent">
                    <div class="tab-pane fade active show" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                        <div class="bg-light border rounded-3">
                            <div class="align-content-lg-start p-lg-3 border-bottom">
                                <h3>All users</h3>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-sm ">
                                    <thead class="border-top" >
                                    <tr>
                                        <th scope="col">Id</th>
                                        <th scope="col">Name</th>
                                        <th scope="col">Last name</th>
                                        <th scope="col">Age</th>
                                        <th scope="col">Email</th>
                                        <th scope="col">Password</th>
                                        <th scope="col">Roles</th>
                                        <th scope="col">Edit</th>
                                        <th scope="col">Delete</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <th:block th:each="user : ${users}">
                                        <tr>
                                            <td th:text="${user.getId()}">Id</td>
                                            <td th:text="${user.getUsername()}">Maxim</td>
                                            <td th:text="${user.getLastName()}">Markov</td>
                                            <td th:text="${user.getAge()}">14</td>
                                            <td th:text="${user.getEmail()}">test@gmail.com</td>
                                            <td th:text="${user.getPassword()}">pass123</td>
                                            <td th:each="role,iter : ${user.getRoles()}" th:text="${role.role.replaceFirst('ROLE_','')}+(${!iter.last} ? ', ' : '')">USER, ADMIN</td>
                                            <td >
                                                <button type="button" th:action="@{/admin/{id}/edit(id=${user.getId()})}" class="btn btn-info">Edit</button>
                                            </td>
                                            <td>
                                                <button type="button" th:action="@{/admin/{id}/edit(id=${user.getId()})}" class="btn btn-danger">Delete</button>
                                            </td>
                                        </tr>
                                    </th:block>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                        <div class="bg-light border rounded-3">
                            <div class="align-content-lg-start p-lg-3 border-bottom">
                                <h3>New user</h3>
                            </div>
                            <div class="newdvfjhvf">

                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </main>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
<script src="cheat.js"></script>

</body>
</html>

