<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dashboard Template · Bootstrap v5.0</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">

    <link href="../static/css/styles.css" th:href="@{css/styles.css}" rel="stylesheet">
    <link rel="stylesheet" href="../static/css/modalWindow.css" th:href="@{css/modalWindow.css}">

</head>
<body>
<header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
    <span class="navbar-brand col-md-3 col-lg-2 me-0 px-3"  th:each="role,iter : ${currentUser.getRoles()}"
          th:utext="(${iter.first} ? ('<b>' + ${currentUser.email} + '</b>' +' with roles: ')) + ${role.role.replaceFirst('ROLE_','')}+(${!iter.last} ? ', ' : '')"> </span>
    <div class="navbar-nav">
        <div class="nav-item text-nowrap">
            <a class="nav-link px-3" href="/logout">Logout</a>
        </div>
    </div>
</header>

<div class="container-fluid">
    <div class="row">
        <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
            <div class="d-flex flex-column flex-shrink-0">
                <ul class="nav nav-pills flex-column mb-auto">
                    <li class="nav-item" th:each="authority : ${#authentication.getAuthorities()}" th:if="${authority.getAuthority().startsWith('ROLE_ADMIN')}">
                        <a href="/admin" class="nav-link active" aria-current="page">
                            Admin
                        </a>
                    </li>
                    <li>
                        <a href="/user" class="nav-link link-dark">
                            User
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <h1>Admin panel</h1>
            <div class="bd-example">
                <nav>
                    <div class="nav nav-tabs " id="nav-tab" role="tablist">
                        <button class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">Users Table</button>
                        <button class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">New User</button>
                    </div>
                </nav>
                <div class="tab-content" id="nav-tabContent">
                    <div class="tab-pane fade active show" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                        <div class="bg-light border rounded-3">
                            <div class="align-content-lg-start p-lg-3 border-bottom">
                                <h3>All users</h3>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-sm ">
                                    <thead class="border-top" >
                                    <tr>
                                        <th scope="col">Id</th>
                                        <th scope="col">Name</th>
                                        <th scope="col">Last name</th>
                                        <th scope="col">Age</th>
                                        <th scope="col">Email</th>
                                        <th scope="col">Password</th>
                                        <th scope="col">Roles</th>
                                        <th scope="col">Edit</th>
                                        <th scope="col">Delete</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <th:block th:each="curUser : ${users}">
                                        <tr>
                                            <td th:text="${curUser.getId()}">Id</td>
                                            <td th:text="${curUser.getUsername()}">Maxim</td>
                                            <td th:text="${curUser.getLastName()}">Markov</td>
                                            <td th:text="${curUser.getAge()}">14</td>
                                            <td th:text="${curUser.getEmail()}">test@gmail.com</td>
                                            <td th:text="${curUser.getPassword()}">pass123</td>
                                            <td th:each="role,iter : ${curUser.getRoles()}" th:text="${role.role.replaceFirst('ROLE_','')}+(${!iter.last} ? ', ' : '')">USER, ADMIN</td>
                                            <td >
                                                <button class="btn btn-info modal-btn">Edit</button>
                                                <!-- Модальном окно -->
                                                <div  class="modal">
                                                    <!-- Модальное содержание -->
                                                    <div class="modal-content">
                                                        <span class="h4" >Edit user</span>
                                                        <span class="close rood">&times;</span>
                                                        <hr/>
                                                        <div class="text-center">
                                                            <form name="myForm" th:method="PATCH" th:action="@{/admin/{id}(id=${curUser.getId()})}" th:object="${user}">
                                                                <div class="form-row">
                                                                    <label for="validationServer0" class="form-label fw-bold m-0">ID</label>
                                                                    <input type="text" class="form-control " th:name="id" th:value = "${curUser.getId()}"   id="validationServer0"  disabled>
                                                                </div>
                                                                <br>
                                                                <div class="form-row">
                                                                    <label for="validationServer06" class="form-label fw-bold m-0">First name</label>
                                                                    <input type="text" class="form-control" th:name="name" th:value = "${curUser.getName()}"  id="validationServer06"  required>
                                                                </div>
                                                                <br>
                                                                <div class="form-row">
                                                                    <label for="validationServer07" class="form-label fw-bold m-0">Last name</label>
                                                                    <input type="text" class="form-control" th:name="lastName" th:value = "${curUser.getLastName()}" id="validationServer07"  required>
                                                                </div>
                                                                <br>
                                                                <div class="form-row">
                                                                    <label for="validationServer08" class="form-label fw-bold m-0">Age</label>
                                                                    <input type="number" class="form-control" th:name="age" th:value = "${curUser.getAge()}" id="validationServer08" th:max="255"  required>
                                                                </div>
                                                                <br>
                                                                <div class="form-row">
                                                                    <label for="validationServer09" class="form-label fw-bold m-0">Email</label>
                                                                    <input type="email" class="form-control" th:name="email" th:value = "${curUser.getEmail()}" id="validationServer09"   required>
                                                                </div>
                                                                <br>
                                                                <div class="form-row">
                                                                    <label for="validationServer10" class="form-label fw-bold m-0">Password</label>
                                                                    <input type="password" class="form-control" th:name="password" th:value = "${curUser.getPassword()}" id="validationServer10" required>
                                                                </div>
                                                                <br>
                                                                <div class="form-row">
                                                                    <label for="editRole" class="form-label fw-bold m-0">Role</label>
                                                                    <select id="editRole" name="roles" multiple size="2" required class="form-control form-control-sm">
                                                                        <option value="ROLE_ADMIN">ADMIN</option>
                                                                        <option value="ROLE_USER">USER</option>
                                                                    </select>
                                                                </div>
                                                                <br>
                                                                <hr>
                                                                <div class="text-end">
                                                                    <input type="reset" class="btn btn-secondary close" value="Close">
                                                                    <input type="submit" class="btn btn-primary" value="Edit">
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>

                                            </td>
                                            <td>




                                                <button class="btn btn-danger modal-btn">Delete</button>
                                                <!-- Модальном окно -->
                                                <div class="modal">
                                                    <!-- Модальное содержание -->
                                                    <div class="modal-content">
                                                        <span class="h4" >Delete user</span>
                                                        <span class="close rood">&times;</span>
                                                        <hr/>
                                                        <div class="text-center">
                                                            <form name="myForm" th:method="DELETE" th:action="@{/admin/{id}(id=${curUser.getId()})}" th:object="${user}">
                                                                <div class="form-row">
                                                                    <label for="validationServer11" class="form-label fw-bold m-0">ID</label>
                                                                    <input type="text" class="form-control " th:name="id" th:value = "${curUser.getId()}" id="validationServer11"  disabled>
                                                                </div>
                                                                <br>
                                                                <div class="form-row">
                                                                    <label for="validationServer12" class="form-label fw-bold m-0">First name</label>
                                                                    <input type="text" class="form-control " th:name="name" th:value = "${curUser.getName()}" id="validationServer12"  disabled>
                                                                </div>
                                                                <br>
                                                                <div class="form-row">
                                                                    <label for="validationServer13" class="form-label fw-bold m-0">Last name</label>
                                                                    <input type="text" class="form-control" th:name="lastName" th:value = "${curUser.getLastName()}" id="validationServer13"  disabled>
                                                                </div>
                                                                <br>
                                                                <div class="form-row">
                                                                    <label for="validationServer14" class="form-label fw-bold m-0">Age</label>
                                                                    <input type="number" class="form-control" th:name="age" th:value = "${curUser.getAge()}" id="validationServer14" th:max="255"  disabled>
                                                                </div>
                                                                <br>
                                                                <div class="form-row">
                                                                    <label for="validationServer15" class="form-label fw-bold m-0">Email</label>
                                                                    <input type="email" class="form-control" th:name="email" th:value = "${curUser.getEmail()}" id="validationServer15"  disabled>
                                                                </div>
                                                                <br>
                                                                <div class="form-row">
                                                                    <label for="validationServer16" class="form-label fw-bold m-0">Password</label>
                                                                    <input type="password" class="form-control" th:name="password" th:value = "${curUser.getPassword()}" id="validationServer16" disabled>
                                                                </div>
                                                                <br>
                                                                <div class="form-row">
                                                                    <label for="deleteRole" class="form-label fw-bold m-0">Role</label>
                                                                    <select id="deleteRole" name="roles" multiple size="2" disabled class="form-control form-control-sm">
                                                                        <option value="ROLE_ADMIN">ADMIN</option>
                                                                        <option value="ROLE_USER">USER</option>
                                                                    </select>
                                                                </div>
                                                                <br>
                                                                <hr>
                                                                <div class="text-end">
                                                                    <input type="reset" class="btn btn-secondary close" value="Close">
                                                                        <input type="submit" class="btn btn-danger" value="Delete">
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </th:block>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                        <div class="bg-light border rounded-3">
                            <div class="align-content-lg-start p-lg-3 border-bottom">
                                <h3>Add new user</h3>
                            </div>
                            <div class="text-center">
                            <form name="myForm" th:method="POST" th:action="@{/admin}" th:object="${user}" class="table-responsive">
                                <div class="form-row">
                                    <label for="validationServer01" class="form-label fw-bold m-0">First name</label>
                                    <input type="text" class="form-control" th:field="*{name}" id="validationServer01" required>
                                </div>
                                <br>
                                <div class="form-row">
                                    <label for="validationServer02" class="form-label fw-bold m-0">Last name</label>
                                    <input type="text" class="form-control" th:field="*{lastName}" id="validationServer02"   required>
                                </div>
                                <br>
                                <div class="form-row">
                                    <label for="validationServer03" class="form-label fw-bold m-0">Age</label>
                                    <input type="number" class="form-control" th:name="age"  id="validationServer03" th:max="255"  required>
                                </div>
                                <br>
                                <div class="form-row">
                                    <label for="validationServer44" class="form-label fw-bold m-0">Email</label>
                                    <input type="text" class="form-control" th:field="*{email}" id="validationServer44"  required>
                                </div>
                                <br>
                                <div class="form-row">
                                    <label for="validationServer05" class="form-label fw-bold m-0">Password</label>
                                    <input type="password" class="form-control" th:field="*{password}"  id="validationServer05"  required>
                                </div>
                                <br>
                                <div class="form-row">
                                    <label for="editRoles" class="form-label fw-bold m-0">Role</label>
                                    <select id="editRoles" name="roles" multiple size="2" required class="form-control form-control-sm">
                                        <option value="ROLE_ADMIN">ADMIN</option>
                                        <option value="ROLE_USER">USER</option>
                                    </select>
                                </div>
                                <br>
                                <div class="h3">
                                    <button class="badge bg-success" type="submit">Add new user</button>
                                </div>
                            </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="../static/js/modalWindow.js" th:src="@{js/modalWindow.js}"></script>
</body>
</html>

